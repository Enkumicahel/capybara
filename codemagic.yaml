workflows:
  build-ios:
    name: Build iOS
    environment:
      xcode: 12.4
    scripts:
      - ifconfig | grep 10 | grep inet
      - flutter packages pub get
      - find . -name "Podfile" -execdir pod install \;
      - flutter build ios --release --build-name=1.0.$BUILD_NUMBER --build-number=$BUILD_NUMBER --no-codesign
    artifacts:
      - /tmp/xcodebuild_logs/*.log
  google-play:
    name: Google Play release
    max_build_duration: 60
    environment:
      vars:
        # GOOGLE_PLAY_TRACK: Velodrome
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmdZZU4wRlBPWUpFcnhyeGJEYlk2QV9kM2sxdzBEbEVNc2xqVm5iT2YwMTJyc0Z3SlktN29TcGFOVzNZcVpPZ3FVQl8zS3JkUGZxUml5WEhVVi11R19oSmNHbXdGZFF3TGM4OEpSWWI3Q1NZWldPY0p0U1FqbjdDeDhnVGwzMjlFRXNGblFiTFl5elZpMmtXdXhBRzhPdkxDZE5pUGNicVdkX1lPVm5falJfRXg3cVk4ZDFDYjY4Q2xSSk5XNnViWHFzOHoxd1B2TkExQUdqeXlxU1F1NG14WkRDM2lqUzM1TTZ6ektMYnAyNzJ5cG1acC1VV1YyUGNZalhtbWpKRWRqdl8yZ2lzWllONDJqamJReWhLMmp2Wjd5UHMzNTBDLUFrZXEtb0xCYTViYV9ZQzhaRTc4UjRqX3RLc3BRQUQ5bGZDVE1ZNXMtY2N1UEpXNkw1dHFidGNZOWIzT3NDcUNxZDlYalM5U3U0eUF0WWxzUVdHWFJIWFg0S1lDWEJVREtlRG5Db0ZXYU95UDBnbmhIZkp1bzZkd1R2d041b185ajR5S0dzMWxBNmRrekdmYUdsQTFSVGg0QzNDd0twRTJpSGRIclhsNFZWX1QtODlKSFdmV01WLVZ6eGRUMUdqR2xZem5aVm5sOVpTN1pDeTVJcXRZQmhxck1ZcUs1dWNrUl9pWUo3UlpGQ0RNR1IwWlJoNGdzUVE3VGRIaXZtcXBybm9WRTBUcHo5S2lCMXVxcUVFQXhEZ01RV2ZibG9rejVvWFNoYWU1TzlyT0t0SmNvakhXWU83em91cHhsdTJjZDZPemQ2ZkxwSkxaekxrTkZXRENwNXNSOXlkS3BJLWhlVFFrLW1qUVhZVDNpWWNGY1p2Q2RaSDRfR1NRUzM3TUprNlE0c2Q5a292bmhUNnpUbW8tWTBzRmhabEtqS2phMkxFbHpaYXVNeHlTMWFWVG5UTXJxOHk0dTN6bTNFVGFjUlF5OHEyU21PNUhGLVhmZFVlcVcwTUc0MEF2QXgwb2gtRmozbzRrMnlZNnNHb2t6MTc5Z1BIdlh3LWRQN0h2ZlVMUVZNbVJHTmkyV2xnRThLS3NTN2hacWpnYnNxb2g3bGFGZ3FDLWJiamFHb2tYZ2d4ZXJtb2ZNNkFUS1JQUmtwcHdiaXdwQ3FlaUdNdlRac3hiZ3hvaS1Namt3b3hTMkJrcGVWM28tc2FNakEwTG93VEVaSy10RFc2UTJUcHAtRWc3VXdWWXZjX2ROV25NWEY4N3pWS3ZiemltNXVYb0RKWHNybGJwUUVmOUhaOVpRX29aWXlQdjVqUWlOLTJDcnRzcWRRYVlDbmpqYnZMWDdxZDZPSzJMUWMyWGEtOGg2MGhVaWhrcWtfbk42Z0k5ems4d1J0WTRIV2FGbHRvU0ozRVd5NzdETUo5VmNoelJGWnRYbHAxQmdnWGJXckpXcHNnMmFodE1felZrbkNFcW1fbUpHOFcxQ282V3ZlTHQ2RGg1Q0VpcWV1eXUzYUhlU1BZVjdxWWlid20zcFc5dU9nN29CMHp5cG9wYkdyNDc1WFp1b0NRd1F3dnQ3NDlBMFlISXZMeFNnZnJPTjNzcTZMVTRLa2NJY3pZdFpZU2hnN0VOVVZVUmRZcktBRW5Ed1FzSk11VnV6SFgxQ045ZlpidkxNVFB3bHh6eGVGNUhuSFg2dnAzWEw5NTVwRGZSX21KSlBiZ0J5NHFuVTBvTHJQaXoxTTJUTnFyN3FnTTIwb3BOd0ZTclRqSkhHNFEwX01GalJLU1pKTXRNNVQ4SlI1cWZxU3R4Y0NnTlJrRzNHbTlWYS03cHkydThuWFp2NUF4dVVHQVNJdDlhYzNZWWhlaHVWUXpJZmlLZldUVGw2SEQtM29VaHlmRk9aWWdQaHVleWVIU2paMTFFMTBLSTZmNmdsN1ZuYjV0dDdoaTd2MGNWMjFfMklXalBMSXBmakQyNVJ1Wk5uUk10R3RNNC1VMDNOWDhQOV9fSXVBS2FwUXd5d21qNkR4RzkzSG1HNk5vaHVMb2VDRm85bWFvNVl6d21MVmktX1VESEZ3aWpibUl0a1lSem1ZdHVnTHpMSGVyRWMyNFRhdGRGeVhXdkNVRlppaUp5WmlKVnVOTzEwZTVycmZMNUo4dlRZTDdkYmRTaUpOWko0UlRpZDgtakF3VFRNY0NlYVhOSldGbE5MSmU4NWp4MUhweTdpS2g3V0pEQWNIMWp4ZzZmUjl6Ukt2NGhIeEhJM2RmQU5jcFUtdzN1eTRmZHRGNlpqNDM1bEl3eUpreVBaZ3d3TjRsenBLbGhRZmIyNmJ2TEVtUU5mMGRYMFRSazA2TkFqN091NmZKTHlfWnhQeWw3MmRSMkdCbDFWa2taVmU4N0NYTjNIRElQOWh5VXBHTHRDYzFsUkxBckk4OFFwdkhQM1JiWE5PMmJDZTNPbkM4c1ZqdWV3a2xpTGlFdGU0QmlKcXBXNkx6X1ZtQjdJc08wc0RkNmg2MDFJcDRxS3pucmxJQlpWM3ZrdGxVRy0yR3gySFo0RHBvUzltSjhhWGpJX0Fmc25hNnhOUHdraml5NzVoZVRMeWRTeFBPQlV1RHBIbGwtaFRmMjllc3JmY2R5NXhUb3VVZU0tNHRvUkRqaUpOeGpYcFVRQ0ZwLTZMdTYwYWk5ejU1UWRQVFpiNzJvUFFzdnpkTl9WOXp0ZHBfZnJuSElfVV9FOGxWZ1QtMUJXcVNmTWlZNGdmRUNXYTI2ZEFjcUNjaDVCX1lTbUVVY2xUY3A4aTk5dzh4ZEVaalFqbThoT2Ruc2Z0ZDVwNHVHUnpfLThJbU1EcGVRZmFSVXJqUWswbUl0UFVlVlVXaWtVXzN1M1ZzSS1XT0p3bG4xRHktVUR0bU9oUnd2bWFiakRWVFJ4TFBjUGU4eXhTa0dodzVvS3N2WHhiQVdxOWhHSUVMbjE2djFqbWg0UDBvTFFZLWRJR3FLS3FoNXE1TVJ0UGJIbmZEZmxSWWZLSHNVVnBuTWU3Nk93ZHVTOEc5Nzk4T0FjN2tLN2Zzc3ZCU2xmamNlUlFXa2cybFR6UFI0WlZUckw4d0hOMkxiM0lSNU9SdjVwLW5JQ1pmRVFNVUFIMFFsWXp0Qk1QLVRacmFuR3R3RG5faDFvS2g3UDFnMnZjaGkyVlJFZ08xLURvN2V0RnhsQVBIRi0tSWhadWhaMjIya2RoVGU4QUxkdmhIMlFfRG1EbXhQcjdFY2dWWWk2Y3A0UU1KdWY3V2g1dUg4d0RpSW8wXy1vaFFibzBKd1lDRGpWcVRrU3JtQWhEZmJTUmFrRWZPRUhfVWxBZkpjMzJmWkw5QWxqN01rRlhZWW4tUGF4SndJUk55S1VVaWd5NlZLelI5TjZacWJGQVdLblZkUzBMSWNrekRSdV9ETTBTQjF0U05zaUhxTWt6T3pna3R6Rng3TC1JRGpCQ053elBvRFZQb3RvdFQ0MnpZNGRIdXBEcVJVZXB4YlZfalk1STR0VnlXdzhyZjVXcDhXV0IyXzBZYWU0Ym1IWHBaN2l0OHI0Y2k0WENqQ3BKN2ZyYXo2RS15TC1ndHZLUGx2amd0S3VCMUlrU2REUUw5TllsLXhtY3V4WFBiTW1MQjloOGtqWXhjOXhSYXBoRzNiZXhWeTVVVHZZSzJxYzlLd0U5VDBOV1E5REZRZmFEZWJySFBIdXdpbUhZQXNzSkJIcElIZjVLSGR2T1ltZkZPa2FWX1dlOHhTSG5EQnVzMU95OU9qUVRVMjhkSnZPVWNPTFZBNGpoWHRqN3hCV3hoVHRBZFNsUjJNNUZOYUdLd1hDTXVLYWx0bHpNZ1FHVUJ5TUNNU0UwODZOcHdXaGlQSHNGeXhYdTVaeHBsTzdlLVJiOG8yb1BrbWp0SDQ4WXhnSVF6MVFiSERKNHkyaElpZjBEeVBPQUU4S3c2UTN3TUw0U0x6YV92UXFJTDZfbmkyU3h5d0RYNEVIbFNDLTNudnl4d0JmbU15V3ZWNUNhXzg4Z2p3WnQtblhfa2h2UlR4RktqUUdQY29ZY1QxQzJJS0xpaGRDcVY3cllJRHBVMVVuVHhWbVpWY2NVUnZrOXhCbmpibWJTRV8wSjZERnlsZWFfd0hRcEJxdi1yd0JXUzlic0ZWSzVKeFZ5MnJ0ck81OVdGLURkOGRnbnhaYXZLbjFlR0hUb3lSNm95OVpseTRqYmNoWWFlbmkwX0VqZHNZSk4wQ1F5NkxFMTk1Q19sbE1jell0aGNQS2p2QmhZMDg2VWFxSW44NTBLVDlUMVpFUGpRRWZrcFVJd1ZyNmFUaDFsZnFBSW05MXhsX1lEaEF2MnVBRldOUklrZ0pEd2M2ZHBlaG5wel9HdVNFUjFiZ3pQWEFCZVRXRWc1bXdFbnltam5qODZyR0toSXVRdnA5LWo3UFJHdUZxU2dSYXNmSjd6N2ZRMjJENzFSRk9mSVVFdUlpZWczWXJiZVpadk45RzI4eTZqMWxsMl9YcTBaSWN1UGpMUVUtZ2xkUEVZeTFFTUNjUzV0T3NITHdld0N2X0FNOXJJa25lRW80X2hDSnRpTVlRQ1JSWF82b25EX191Ri1xOS1iQlR0TWZDQzctc2J6SzlMc3VkdDZQRnNzd1VPMG5mVGZRZmJ0RzM2Zng5RG5fYzI5UkZGS3prZHZHOGNYU01BbDRkMUpqWmg5TVlEdjFQX0hFMHJLVU9SbHhJZDc4OU1SZEJBeFlFZll2bjM5OWV0VWVqWUhUOHNacW9Lc3JCeElkbXhxTk0tV1dOWlhCVFljOFBtT1Nic2pFNDI4U0VrNlY3Vk1sMDFZNU13c3QwZHltX1gzc2p4WFV1Wnp2UDdMaGJJTXRIUFRqbmk2SVRLV2Q2MkJqRjJWTkxtdEVuZmUyT0x0UG9jT2xHZlR1djJfME5LbDhiRmZlRU1Jd2hTVXYwM05tOHRycHFiZ1lOVmltT3ZmT3laVWNuenZuVktNSi1ndEljRmZvSlNiTU1zb203c3E3WFVNVDhHT2h4Rms5WFBWb0xjSU5icWtoeVVyeWthcGZYQmctUkVzNHgwd1Ryb2UyTTdOWmFsQ1ZWUlpBOEo4c0ktRnVnM0tXd0hjUEtjbWJUTXI1NThWYVY0T2tSLWQxOHRpeFNYazF6RWZPaXV6TVNGYjZib0tJWXRtZWNRcFdkT0ZtSGtJQUpnS0d0d213TWJacW43Z3FSeUxaUG9aNzc0Q1hlc2d2bC1GcTdQLU5waUxQcmxwaGY4SHljenlNbFRnWjFKVlZzYXZJRS1rLUUybWNndFAxR0xiOEh5czZEZVBoLTZXTVBrT0xjbVFneVRIZTUtbzQ2c3JGdmRpclVFYWozY2c0OXVnaTJZT1ZOX0VtNV96QVhaNk5XcnJSLVN4Wld1aV9nc3k3MzJUNGZIUT09)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdZZU4waFAzbHA3S3l0UlE0U01IYS1sWmowWG1Kb05PaWVIX1FNUjZsQ0xMc2ZzMlVfbWFuazh0c2tjQnduMEhxYUlzQnhGOTJqejd1TjZWRWxhdDdkRHRZYUE9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmdZZU4wY0lEbXZzbm1SVnlzaUhibUZ6ejVlbmxXcjkxUnZlUGdGbnljZjlqRTJmYlBXc1VoMV80ZVVXcS0xQWFZMWQ0d2dQYlFhdTRjc0hGNkhNSVFXLWdLbWc9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmdZZU4wd05ZYUtEUUpSRWNiSmdBUGpkbGNQNzNXckRTczJVRVVqTjJHakFFbDhRd1VXbHI2Y0Fad1VmNGR3QnhXUVlPSjVpVVNNSkVlQWVzQkYwa2JTVFV0NUE9PQ==)
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - |
        # set up key.properties
        echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$FCI_KEYSTORE_PASSWORD
        keyPassword=$FCI_KEY_PASSWORD
        keyAlias=$FCI_KEY_ALIAS
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - echo $BUILD_NUMBER
      - flutter build appbundle --release --build-name=1.0.$BUILD_NUMBER --build-number=$BUILD_NUMBER
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
    publishing:
      google_play:
        credentials: Encrypted(Z0FBQUFBQmdZZU4wLVRHZmYtTGRvek1nMjBXMTFHTUJ4Q184RXJMckxNR0VNeG9YbVVadldHVHdscXpOaGY5TjFkZEJOV2k1Q3liMEtiTkE2UlhDbnJCdk9CWTJFZmFqdmpoUXRHejlzeGhTeU9RandEbE1RRHh3cFQ1cUdKOVFzbkRyVmdldEVZYnVGZjNRMVB5Z3JMX1FwSjdndlFQNFE2RnpHWlJwQXY2NFUycEc5S0Fub1M3TFdCZGtZRG4wbGxWS1dDZnhPZl82ano0TVFSQU5qRmVlTEtqMXBGN0RySE9majhVbUc3Ujl0Q0tOdnd3dlNMNFFwMnhFczdVc19tZlpYWkFocVJsckJCZkJ3VnV6VlV5U29FZ2x6N0w0Z0ZwXzRSMFd3OXF0bXdSaXA2VWxpd1NjcHktRFdOcDVmaVlaUUM3a3hqdHR4aHA1RWV4SVNJa0F1ZTdEaVc1OXJacDAzUmlnSnpvLWl0UGxra1NmN0x5RGo1NzJBakd3ZnRkVkhFRlJmbGxNNzFYVk9KMk8xc0JWem5CWDNFUkw2Z1ZnSnJtNkZsTld3U21mektSVmJCNE9IZjNBNHhRWmhLV0tvYUlwbjdoXzc3V3FpeTl1RkdfamNSdXZac2JhaFZYNXNBNDZNRjNSRzJ2dld2bF92M0FxQ2FfVWRxT0x6X1ZvMDhlc3BSbW1MTWRZbEhxSG0zX1ljS2dIMWlOVVdJa083VWNqaXhPUHJWWWxhZ0liUGsyTThtSEl0RzZHQTdXS3ZrRmFCNFFaclI3MlozVFRxRkJscmpFckU4RjkxUzZZQVN1NV9uU2VSbE9jMXFJRnM4Wnlkemp1NHJCeUg3bWtvYlNEVzJRLVRTWFdJVWdPVVdZVDdVQmdtMVVtdVd1MW9xTnBEUGJUNU5DYjVOdWhUTXhjV2JDdVpQbnhaMXZBZ0pBMlBqbGV3ZVRLZVlXZmVldFY0cUhqSEdjZ1dvSEItWnp2dHZpeGRSamhHUVJyM0VqNWQySEVvTnYwbEs1UzdNRk5uM2ZvVTVuSXZsZVQxMjNTcS1vZEFJcHdlX2E1WVlLRkpPbjhkNnVPR0Fxa3VoR09SSXh5c3RFZWxqZFFiaTFLWU15OENKdzBFY2gyMUNodHRpN1k1YU1BQkNLMkNSVmZHVHE0SUFRaGdKWEVDUFhGd1JNTDdpZWo1NXBzNmlZUXp2MWtIRTdiYlhuV2lSM0hHOUcxWEM2U0NrLUE2N0E4VElsdjI4WG1DbWtCd1JmRVAzY3oxdGtwUGtjei1jRXQ0OTgxdDhHNE4tSWs0cVRtVWZxS3plUkYwRTlkZWh0MFVWeC1CLVpOYWFyOVBhcGMyeVpxdDJHT1ZPME5mdU16dnJQTmVPWklEN0hjWGRMQW14cWE2WW52X2Z5UlktVVBVSDVqU1JSRnhpdG8wMFZRMEZxaTZUWVFwb1FKcldaZUhyYmRFMEhtMHFmWTZOTE8wZDhTZEpRcXdDNDgxNVVuSnRMV09GZ0VoelRPTXZ2UTJFbXl3aXpBbzdIWi1WNlU3bll0aDQ3QXFzYnYzSU1hcjFsNjhGOGJhQTFoRk1XSXQyN2hic2JPYVJmSG1lODlWN2hqMExIU2JxUkRQMTBmMDRJSGRrZzV3YjlYNEhFcDlJNEh1eTNIY0lqQ2R3TG1mOGdoOTlmUUJxX3VPQTNyR20yeUlyeE43UVNIQkVyNk96bFdOdWdVTzBraGdBUEZlWmdqMGNPSkFQbkNPZkNRT2Q4MUctcmFuX0pGdWp0UXVqQW1sdmRxQ1g2Z1dnQ0xNVjh6RWlDNURhREgwS1RlZHJKNjFMRGVnMmFLbnpDcldqN21mZkJoX05WelE5WGZIYlB2Q3llaE5uNDk4d3ZKRWhCMXhjUlpsY09ESXZma2xtbGRvSE5lUGtxTmtqdk12QV9LQ1oyLTFfMzNyVmJlX3hDMDdUd3dtNllncFk0Y3ljdklnMWlfY3c5TjZramxBeGttOTAxWlNWNkZxeDJZZ3ZFTXJVWThQUHZ5OWlaN293eFJmS1k0ZGVOV2ZoRGx0YWxacUlaUDlDRDEwZTR6RnlySjJWRWsyY084WFloNFNWQm5RcWV5eUFrTi12WkVHUjc5V1lPVy1kQW90OWFJZmxsUV9IRFNIZVFhVU9zbkJhRUtfaldjZmt1dWJ3VUtmeF9xbUYtVTZtTzFVNzFaVldKVmlhU3FaSjdWRjRNOTJfVTJIcG40Zi1QaXR2aFdiOWw5aFlwOURNLVNXQTA3SkFNUjJkdTNkZWdfZkpZd2NtblJmMW50Um9ta2tNeDFUR1NiTmdzeDJFVDREZEtqakdTNGJnSkF1YURUTk5OOUNtT2hTOUZ3dWllVUJhbHZzNXJwSGEyQWxKWlYxVmlRYVpFRm80WnZqYUhNa2tvaVk2WmFCWnl1bEtkUWFPaW1NWU1RRGV4TUxiV0wxTkppWXphalRWS3RXTmhVc2F5OUhJVEktSVNmVTFzX1ZMRVJRYlR0OEJlQWtIWlZkOVFnb2FPSGQwTjhmc1FwWXAzc3NjWkozTHlpMmFIUUZyTF9SclprZXZ1T0hUQmR4VWF5eFdTNWVaNWdTTVdITXRHMzMzVnNYV1dFYU9PWGxGam91Ujh3VTRGdWtFMGlLNEstNjNkRmNyeUZES2RqZ1JubGk2V3k3WkNHVTBqRXUweEFvcWwtc3JJbkVNX1l3QUt1djJmQ2owR2MzWm12amttOEF5RnJsVGdfbldQQl9ROTM1ZTBLcHRRSGFZeDlHbVQ5SFNzSl9aRFB2ZWR5akNlR0pWQTlmZXRqTDRlZ3p4T0tkcmNlX2kxd1ZwTjBnNzJYUXJGWXBybXVpTnlOblUyallHaVh6ejQ2NkJYMWZDdmtOTVpCTlJkam8tbFFQSDRaRFNPb20xVmN4TUF1LUhqWXp2OFBicm9GdEYyVm1ycGpwTWFIQVQ5elRtTTVNUXZHSXlZdFBNcG5tdjd2R2dCaTBRLU9qZFFYTU85R0ZMY3M5OEp4TFR6TU9ONFFud3lYbjdSbzFxT3lHc1RtNVc3bUo5ZzJBdzc2Z3VacVJYYUpKV1FZa3VFeF95QlZQdWpwSWdiVlR5Y2FCYUxTYU14WXQzTHZWdUZoWWswNkxrc25aZTRvSnhhMXRISmJ3U2E0VmdfWG16TGNUUXUwZ3FkdkF4c0N1Q0IxNF9HMGx0bktBbDJQU0RDeHRFZ3ZqTldqdklaRlYxQUxhX0g5M3JJVVc1aFhuQlZNMnNMcks1WXhmV3EtYzdFYk11ck1ZRlI2VW5CQmJ0a3JCX2JkeEJqQ3JxRGRJY0Z5VzFaYm1ONHlDWmExMS1nN1ZNcFczMGVWN1RNUzYzVUNvNlVaQmZwX2hrdC1EXzhWSkVpTUdfaEhUNENsX21DcDJxWWFaX2M4ZzNSXzEwTmVtTXhXTVlWRG5xTU9reXNGSEhRQlNFR0JtcXZnajNjZ21XbzVMZHhTRFBkbGdweGFVMTlSVUR1aFJLaGdSSmVhNVpaTThtOG1GQ3BtaXNwS2IxNW1SNzVVaUtndXNxNWpCeGFHS3NPTlBCRk9fZTJZVl83V3ZrYWxnQldnMDRuWGMxdi0tMUlwemF0UFVLMi1fLWpjb1FBTTRQQmZtZ2Nac1RnQksxQmZDeXUtb3Z1bHRWUmZfajg2WFRfcnJsRnRGRk9ZLXpzdnUxbmZ0cjM1bzBnT2hULVVzU2JXemg0LW5TM2xJQzNCZ1VGX1FsSkVjTmhqQlUxSEhLYkdyMUpUMG1rWTdocWkyMlI5WUNHb0RhdDNyU2dWSTBOTHFYbUlyaWxsUUNvV2IzbGFnRjg4RWxlTVlhZmFQaUh1TlE1YVBiaGdrYXZIM2FLckNmSjBCUjhuOVVTNnBUaHAtOXl1S2I0bzBJYjItMXhDdFQxRHBpbnNFNG9OQW5oZTdjaTNNZjlsa2hubGgwZzN0d1BjV21JYlpPRzlVdC03akhDc0kxRWpYaEtXWWdhT1JLVEJjemVwcVdTcEU5d3ZFYlJSYk5LUmQ1Q2l5NEtpZlhQTUFuUzZmYkM3MVBmUllGejlOLTVlc2RJcWZWNjhra0NhcXdzYW9fQ2ExQ0RkSzEwWVFFN0lwTEZlWWZuOWsweF8tN0YzZXo1UmJEZ1F3WEFiZkhaaWl6cFh5bUZSVVNON2p1a0JNeFNuWV9Db3RRYWNTampjX3F3U0FtYS1Kc2xkNi1jdUlSWTZYaGVXSTdrVUM5NUFJazM3aTlYclRiMWpoR3Joc1c4a3NhTlIxRk11cE9UMy0wVC1iX1JIMXNGX0hRSG1nd3piaE4xN3BjQTY5bldZTVE0PQ==)
        # track: internal
        track: Velodrome
        in_app_update_priority: 0
  linux:
    name: Linux
    instance_type: linux
    max_build_duration: 75
    environment:
      vars:
        secure: Encrypted(Z0FBQUFBQmdrQ0VDcWpXOFJIZkd3ODFkbVYzRnZlbnhHYXY1U2pRR0JjbF82eW5TTE53ci0zYklJVklRS0hRazBFVmUwU0tudzBTaUh0M2p5QkU5eUZjQzI4dXhlbjhIdEE9PQ==)
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmdrQ0VDdmlrWFdDLTNzeXZKbnZOM09sY01UUHF5c08wUnNqLVQwTllFemJsZnluVXdrV1RSZHN1TE1QSEE0TlRkTFI5MGZ4TGx5dWo5VUljbkVKYmx5WE5Gc2dpUlJEbEhkWVJuM3E0TVBvaVBFanczSmdBOGRYWTF6YlRZOUxleEZfb3FYSFJ3TGVzeVNpNFlnaFVSVDNVTmxDU2J2Y25JNWs5cEZXR25tYnU0QXRrcjd0Y1I5d0M4YkV5WEpHM0lmQzU3RzRkUnN1RXUwQXFQc0UxVzVVZXpsdUZPQkl3dlJnblRPLWR2bmNhVmpvekExUmJKYTRVVlhsNXQ1RlJtU2JmSm5NMmlEOW40M1RVV1lxSTJ6MGFqN3JPSDNsV19mcWNBbHg3WXBmMWtJUV9qanJGdjItMTJmUUd6YWxlaDNVbE42aFdaN3ZUVFNROHVsbEZpY1ZiWkRXaFdYWWluMFN6cHVqMXgxd0ZVX09lU0w3RVZMYXpqNm9qWUh5cmJQSHJ1VC1Sd3Y2M2dSTmNzNll4VEJPNUhqWC1ncmx6c1h1VTV1aHpYRG9VWjltR2NCX1RzdlJUUkZ0b0NCX2VwTVRfM1k5MnM5OFZUQTMxeUNDMmxCSDJBYnR1bmo1bVNsVnVLa2NoNE1BZ3JZcDVCLW11bUoxUlVDdXV2WGZyNGdNaWxkbEZxUVItWl9LS2swMVBrOUhfNGRpTUxpRlB3ZklVTDlsTHdaWkQyME5LY2h2VjFPU0gwRTBkZmR4Tk5rc2JrQlhuOWJDc3RNVnAzSk00UXhTT1ZCVk1yb2pqVlc0aU5HN25FM2U0QVpIR3RqUC1kX3ZJSlp5OTlBaTdhS0pKVXZGLXFKSDdoaU84V0ExN3pnb2tlMkJ6bldfYlBHUk1GVHZyVXBVLUpJS0V2T2lfVzZuWmw3UG9DaUw3WlRZR1NOUXFMejFUMlpCNWVsVU81Mkp0UjVNbzFxZjJBYnJIXzBPbzRSNU9FVmtVTUNRTzdmV0s5N2ZGeWkyMk1lbUpyaThma0FuUGhLOXZndExQeGg1ekszMnJRTnh5NkxNZDQyTUtCcnNtYWFJalB1cUxYZnQtZFplS2VDSVRXYXFZUFFHVlRlUndEZnN2Y3VaazZvREc4aG5Dakl4cmVJbFJydEhpZkU5WVpfSldPcTRpM29ST3ladkFCbFJyeEp3MV9sbUpDSWZXYmF2VHNibkdsTFJRZDlMYnZwdFdmX2pZMlVaMjBmS2thOTEzMFJxX1RPclVaYlo2NGo1elFBcERoekVkNlNtRnplYkw2WDVuc3NNZDlGejkyNTBCYmNhQldkWE9ra1RYa3pZdEh2eFdKZFdEZ3IyTmN3bnpoOU9LMWRzSFRPaU9pTVNrUmJ6SWkxYWtnUjAxYURGcmJNQUc0eTA4N3dnSjh1dkkwQWh5WXVGY1VkNjljaU1oUnVjcm1XVG5tVWNNdk02aUtKUmxQVmdvY0szLTh0Ykt0S0NRWVhGaVJZZHVjdkFkR1VkS24xelVRQVF1bG1GT3I0NWZ0cTYxdWxPTUlVelR5OVVDcjk3MEJERm5KRWNvSnNNMEFCS3E4Zy03dC1URWVLYnhKY2c1clZTS3RFZENpRmpTd2xHS1hia09fN0NZVC1UVkJENG5Ud2JDeHZXYXlEbnVkcDVuZ21CRTg2cEZKT1I0RV9VOVFDVElRaWEybHUtdHJETGRWU1pYcEljVU01bE14TTJtaDFHd3BXN1Y0OUROVDB2amdSaXhEZ1A2bUpfOUVNQU52WXFqVHVmRWU5T2x2bnZIM204cVR0bHFNdUpWQXk0UHZZMDEyNWlNQzg1YmJMOGQyNlVobjdPMUVncDVQZ1BaYWRManZteUxMN1FNSUJZUzNWd05tNmFWQkJqUlNLdnhoeW9oOWI1V3I3clZmV3Q2ZWxYNUtsLU01Ml9GcWx0R2dXUU5WZjBzTU5pNTB6YjFaMENoRG9ZTXJqbG1rakVfU2I3ckJCZWdWUHFqV2dZUnZxRi1NZUhBTmNuTzU0NkxGYk9Cbm1fQ2IxUXY4THg1RFppeDBqLW1Fc2g5SzNLY3pnWEpReHBFQVMwNFhJYVpSa2JtN2h3ZVJWblo4V1ZvMnBGSENmenJNSmtLODhEQ3dvU3dOX2RmTmhOY0x2RDNjQWRkMHNfRUMzVGN4bFlpM1BpRUxDM2Y1aGlvMWs2c3NheHhaMnBidHZEVm9zeEE0R3EyYldlQWFvaDFYVTliQVZucW9seFRUb29WNl85RzcyMmtEQjNUcU5CZmR2V1FROWpneW5RN0FsWnhFM2R0a2JaUk5HTjhaVTR3QkkwdnVFbXlVR20yZHlUZ1QzWXFueDZ6Q05wYzRwZ29xenJabHg4SWhsYVVGTmtCT29xa1JyQ01aY0N4S2ZORU52QmRuNFBaSmRKZE9QN2haYmdfalNvblo5Q1A3dVlPRV9WbjJXLW9YcGJOcFVyRzZ1cWEteHM1OEJ1eFM5Q25hV3VQX0ZxWFZCaVpVYXdWMVk2S291YzZVN0RzS2dEOGpxcVJtSWpubmQ3aU9nX3UwNnV1MHNWamtaWkRwdExOblM2ZlZqTkFNaHhadkJvbnhFalBFMVd0TlBFVEx4ZEszMndXSnFNUWY4VnZGc2NRZUtwelMtTHkteFNnZDh3QUxqQ3NSbTl3T0xFejBLM2FXQ2dVUWNCSFpRZDdGdFhMTlpnTC1kSFBfOXhLS2JXRjYwVFRHNUszeFBEX2dkU3U2ZlpyN0plYnlKNk01YU1SSWRMVW9Pcjd4dXRvRW9fZ3hUN010MGktQ3RrRjBram9zWWRpUkh5ZE5aVmJtc0dVSXpkcHpJYkZtVnhzZ2pTUDBSZ0VwUThHVURmLV9lYlpQMERjMFc0NWtwcG5QWllzb1VtaW9GaWhSbUJybnZwY2RudWJ4ZFdlU2hvSEMzQTB0eEZoUmJJRWxtY0JmTXl5OWw3aVVMR3dEeEhsNWxFWURaMi16Nl94UmRGakJ4YTB2WTd6MEQ0eU5PLXpnb2l6TlNvT25xZXo0eHBnSGRJZ0hKLURFVURPbGlkcENHZi1MVHlFTUhKLUpoWmd1XzdqU1Z5S2g3WUxuUGtiOHBVWTZkeGFCSXdUNW9HZVk1YzBpeWZ2eGF1THo2b1ZRVW9LUTJOa3Q5dDNuOXNFbUhUT1BVYjZZclNrWWFBcy1raTRqTWVaWGNCOTVXS2VIUGN4NWR1SjVweVRvNUE4NmRCUG1LVzZvQ1pZa1FqT1V3M1ZNdE55eFRlSFIyOXA0NU8wSFlUUmxmQXJEU2VDX1JLcUpBM3RQUVAzV0oyTE5FYklTZDFlVndFUlVYSDFnOHB5b05fMk9ydHcyR1BITk1TUUtjY3VtVGF4T2dMd1FJdzNfdGNYS2haQnNzVVZIWS1GT2xubDJ2cXM1UzdsaGk3eHhwM1RxcXEwRElKQ2ZKcS1GTVU2aVBVSHRDQ2dpbmlXS3MzaC1CVE16MnFkMEdtOFZBaWNkTjI1aEhQTTlYcEFoTDczckFpYkhZXzA0cnhHcUJvSG1GekhDSGFlMHpzdldZS29ScU5VdnQ0Z0ZJdGI4bVZueXJTTUxMUV96dllnazZyaTIyamdPbms1Z2pFVXJsQTY2ck0tb0pPTUtzOHdoMmJjcVphRlFnQnY1N0VKRDF5czZ5Wko0eHJKWXpKblJ2NEZZVlluNTgzdXJXVjFLeXhueFdGdkNRQzVXRDdaVDRYXzA4RThiQWRLSUtRN3c1VWlVbEg1Zmd0TFlBQU1nME9hcXJxUDNXOFljd3d3YTNmN09TWF9WeWRxNXBlcUJXc2xiN3RBb0VONDZHbWRla2FzQWI4a05rY3JPN3NNT01QZ05TVVBvT242U0YydDA5LWx5S09PSm5reFZQNUVQVWprTjNaYXhzMHl3ckJyb1puU1E4bmtIajBXOUFkeGQ2R1p3NFkzbncwM3hDNXlPR1c5ZWdEOEJuUko4NUI4QXRjZHpaMGg1NVB5RXl1NWVWdElhV1NaT3RlcGZKWDZzX3I3bWFrcVBCaUJ2WFprYW5hSm9LaVh5dVozVTk5c3NMbWs1NXRuNU9Kc1RVdzh5Y3lfV2tYQ1paTXhvd0txQzl6TU9ZUUNXZ1dqaFd4Wmg2WmVBRFNCanU5dS10MFVjZUlpbXNfZjR5STRvNGlaOVk3a1pMTmhKUFIyVXN1WXN6aTVySzRrOHY2TlN4V0F2Y3NnM3FFbWh4NU9qTDk4RjhvTUIyQTFNRUp1dXhRZ3VYLXRlSUlnek5HcHRqZm1ZbDM2eGNVVTdfcWJOc1UyV1ctVWg3M2pMc01WbUVDVjlhTXp2RVl1Nk9GcHNzbTBGSXdJUEhHRG4tWGtDUUZxQ3gyRER6XzMxdkJXZkxtOEgzbDc4cDVlbkJSczlCRkwwUHhaVGMzQ2lIZndvRXJfdktseExyZW1KZUF5Vk5IV3ktZTJLTmJyRHBHb0U0STRac3lzczVGRF9jN1Iwd3BZNnRuaU1Vdnh1MHRDYTd3cHJwZDBSVDlfT3daUlVHWmMxVFRxN1BBamE5Nl9HdTVJdE1DZlFYeUU0Y2llUURjT29LLWZzeTJqXzBzcUwxZkVQWVJpQXZSVkpFcnNzbUc1ZVRzdGJHYk9YeGtfM0xjeTRGYTZxY09SMWV0WDdTY2lRZUtnUTVTNUhPSHlfWUVhcmdscjJxODJrZlYxZjZoRlFhWlg2QzYyeHlodlNPYjQybjdTVEkweHBGWFBlTi1udUFKel9yR0RuT3gwT1lidUxCMkF5bzdMXzRFSHdZWEFXZHc0OFpJTm5zSWcyQ21UU0RWdndwdnJBeTg2Xzl5ZXJuUjU1a0hVVkp4YVBZOVpoT0VoQ0VQRkdwZkhzdzgyUWE5bnU1a0xwZ2lPNkVfMWhKOXlCREZjVUxMaUU3RjFyQUktTXNUZm9oVmtRVHJRUWh4cFZsSWJvT2tkel8wbXlBa1hubWtKemM4SWI1aEdHWUhvdkF5SWctX2V0MldueklUd0R0ZUMzZjdXQlpOenF2MW9wUGVMa1BnZlZyTE1iRGMxOVJKM3lnX2g1LVVCdng2U2FkWVF1RTdHeWptRkE3U2ZnbDdSOXprdDNOV2R6RE5zQ3BvM3ZsX1RnT1hLTXU4b1llSVd3aDNydXRTaHZFMEJrM282MWdTSHZfWXhKdGxsWVFja3FaalJlSGVZRFlKaUpLLXJReHhtTTR5eGx1SlBMTUpwcDg4SWJ6R3EybkU2blFNdnlISUo0TXBSRkx5b0x4b19VWm4yNnlBYkJjdHozNmNjUldFSFpZMHhWc1pfQ3JOX05rWGJONVFaM2NnSFlRNTRXV2xFek1vWUZObG9GX1BoRWRMOGUxT0c0YTF6QkNCYmxwUHBaVGlZVzYwUE5sdz09)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdrQ0VDeHFRX0pGMEJLcXBhVUhDS3NsMTdoNzRJRVBtcmR3ZEs3WTBGeHBhcE9wWDdSQW0yWkd1Q2RGUnQ4WXI5Y25ZRFNiWmJQUzAxS3NSUHZaV0ZQX0p1dWc9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmdrQ0VDeGxUd3djYUpPeGdxUXVmQVZrdkJudWVMbTZtRnBCVlkyUUh6SHZ2NUZDbVFsVThHUlJlTWdua0FIRmFNNWRacFc1NTlSSnl6SVJpYXZRclRVcHBXVmc9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmdrQ0VDTlVySHViM1kyeUhWYnJBaWlHeDNOa0pURHJ5UWdMbGZPYVgyQmNFY2JMcUFSTkw3TkhGTEFobEpDQ09CNnItelJELWdQdXYzeXJaUjZKdkgxX0xFdFE9PQ==)
      flutter: stable
      xcode: latest
      cocoapods: default
      node: 14.16.0
      npm: 7.11.2
    cache:
      cache_paths: []
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
      tag_patterns:
        - pattern: '*'
          include: true
    scripts:
      - |
        # set up key.properties
        echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$FCI_KEYSTORE_PASSWORD
        keyPassword=$FCI_KEY_PASSWORD
        keyAlias=$FCI_KEY_ALIAS
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter test
      - flutter build appbundle --release --build-name=1.0.$BUILD_NUMBER --build-number=$BUILD_NUMBER
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/web.zip
      - flutter_drive.log
